<ROSETTASCRIPTS>

  <SCOREFXNS>
    <ScoreFunction name="fullatom" weights="talaris2014" />
  </SCOREFXNS>

  <RESIDUE_SELECTORS>
    # Template: 3lhp.pdb.gz: Engineered protein.
    <Index name="insertion" resnums="49S-70S" />
    <Chain name="chS"       chains="S" />

    # Motif: pdbs/4oyd.pdb.gz: COMPUTATIONALLY DESIGNED INHIBITOR
    <Index name="query_motif"   resnums="43B-64B" />
    <Index name="target_region" resnums="1B-116B" />

  </RESIDUE_SELECTORS>

  <FILTERS> # (confidence=0 -> to score not to filter)
    # Check global (helix) RMSD
    <RmsdFromResidueSelectorFilter name="GlobalHRMSD"
      reference_name="template_pose" reference_selector="target_region" query_selector="chS" confidence="1" />

    # Local (helix) RMSD
    <RmsdFromResidueSelectorFilter name="LocalHRMSD" superimpose="false"
      reference_name="template_pose" reference_selector="target_region" query_selector="chS" confidence="1" />
  </FILTERS>

  <MOVERS>
    # The "template" is the one pose from the assemble that we are not piping as input
    <SavePoseMover name="load_template" reference_name="template_pose" pdb_file="pdbs/4oyd.pdb.gz" />

    # Local Alignment for RMSD 1
    <AlignByResidueSelectorMover name="align" reference_name="template_pose"
      reference_selector="query_motif" query_selector="insertion" />

  </MOVERS>

  <PROTOCOLS>
    # Global First
    <Add filter="GlobalHRMSD" />
    # Loop align-eval
    <Add mover="align" />
    <Add filter="LocalHRMSD" />
  </PROTOCOLS>
</ROSETTASCRIPTS>
